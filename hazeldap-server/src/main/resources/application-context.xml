<?xml version="1.0" encoding="UTF-8"?>

<!--<beans xmlns="http://www.springframework.org/schema/beans"></beans>-->
<!--<beans>-->

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:hz="http://www.hazelcast.com/schema/spring"
       xmlns:ldap="http://www.springframework.org/schema/ldap"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
              http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
              http://www.hazelcast.com/schema/spring
              http://www.hazelcast.com/schema/spring/hazelcast-spring-3.11.xsd
              http://www.springframework.org/schema/ldap
              http://www.springframework.org/schema/ldap/spring-ldap.xsd
              http://www.springframework.org/schema/context
              http://www.springframework.org/schema/context/spring-context.xsd

">


    <!--    <context:config-scan base-package="com.hazelcast.poc"/>-->

    <context:property-placeholder location="classpath:application-context.properties" />

    <context:component-scan base-package="com.craftedbytes.hazelcast"/>

    <hz:hazelcast id="hazelcast.instance" >

        <hz:config>

            <hz:spring-aware/>

            <hz:group name="dev-secure" password="this is ignored"/>
            <hz:license-key>${hazelcast.license.key}</hz:license-key>
            <hz:management-center enabled="true" url="http://localhost:8080/hazelcast-mancenter"/>

            <hz:properties>
                <hz:property name="hazelcast.logging.type">jdk</hz:property>
                <hz:property name="hazelcast.phone.home.enabled">false</hz:property>
            </hz:properties>

            <hz:network port="5901" port-auto-increment="true">
                <hz:join>
                    <hz:multicast enabled="false"/>
                    <hz:tcp-ip enabled="true">
                        <hz:member>127.0.0.1:5901</hz:member>
                    </hz:tcp-ip>
                </hz:join>
            </hz:network>

            <hz:security enabled="true">
                <hz:client-login-modules>

                    <hz:login-module  class-name="com.craftedbytes.hazelcast.security.ClientLoginModule" usage="REQUIRED">

                    <!--<hz:login-module implementation="clientLoginModule" usage="REQUIRED">-->
                        <!-- class-name="com.craftedbytes.hazelcast.security.ClientLoginModule" -->

                    </hz:login-module>

                </hz:client-login-modules>

                <hz:client-permissions>
                    <hz:map-permission name="importantMap" principal="cn: StandardUsers">
                        <hz:actions>
                            <hz:action>create</hz:action>
                            <hz:action>read</hz:action>
                        </hz:actions>
                    </hz:map-permission>
                    <hz:map-permission name="importantMap" principal="cn: Administrator">
                        <hz:actions>
                            <hz:action>create</hz:action>
                            <hz:action>destroy</hz:action>
                            <hz:action>put</hz:action>
                            <hz:action>read</hz:action>
                        </hz:actions>
                    </hz:map-permission>

                </hz:client-permissions>
            </hz:security>

        </hz:config>
    </hz:hazelcast>

    <ldap:context-source
            url="${ldap.url}"
            base="${ldap.base}"
            username="${ldap.username}"
            password="${ldap.password}"/>

    <ldap:ldap-template id="ldapTemplate"/>

    <bean id="userStore" class="com.craftedbytes.hazelcast.ldap.LdapUserStore">
        <property name="ldapTemplate" ref="ldapTemplate"/>
    </bean>

    <bean id="clientLoginModule" class="com.craftedbytes.hazelcast.security.ClientLoginModule">
        <property name="userStore" ref="userStore"/>
    </bean>

</beans>
